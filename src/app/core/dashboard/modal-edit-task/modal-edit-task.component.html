<div class="modal-container" @modalBackground *ngIf="modalBackground"></div>
<div [formGroup]="editTask" class="modal" @flyInOut *ngIf="loaded">
    <div class="modal-header">
        <input tabindex="1" type="text" class="h3 edit task-title" placeholder="Title" formControlName="name">
        <div class="modal-controls">
            <div class="dangerous-controls">
                <button class="tiny-button no-background" [disabled]="!editTask.dirty || isNew" (click)="undo()"><div class="img" [inlineSVG]="'/assets/icons/icon-undo.svg'" alt="Undo"></div></button>
                <button class="tiny-button" [disabled]="!task" (click)="delete()"><div class="img" [inlineSVG]="'/assets/icons/icon-trash.svg'" alt="Delete"></div></button>
            </div>
            <button class="tiny-button no-background" (click)="close()">
                <div class="img" [inlineSVG]="'assets/icons/icon-exit.svg'"></div>
            </button>
        </div>
    </div>
    <label for="task-description">Description</label>
    <textarea tabindex="2" type="textarea" id="task-description" class="task-description edit scroller" rows="5" placeholder="Describe your task here" formControlName="description"></textarea>
    <div class="row">
        <div class="due-date">
            <label for="due-date">Due date</label>
            <input id="due-date" type="datetime-local" class="edit" tabindex="3" formControlName="dueAt">
        </div>
        <div class="workload">
            <label for="workload-hour">Workload</label>
            <div class="workload-time">
                <input id="workload-hour" type="text" min="0" max="24" class="edit" step="1" tabindex="4" formControlName="workload">
            </div>
        </div>
        <div class="priority">
            <label for="priority">Priority</label>
            <input id="priority" class="slider" type="range" min="1" max="3" step="1" value="2" formControlName="priority" tabindex="5">
        </div>
    </div>
    <div class="row" *ngIf="task">
        <div class="progress">
            <label for="modal-progress">Progress</label>
            <div class="progress-container">
                <progress id="modal-progress" class="large" max="100" value="0" [value]="getProgress(task)">{{getProgress(task)}}"%</progress>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button class="btn large save" (click)="save()" [disabled]="!editTask.valid || !editTask.dirty"><div class="img" [inlineSVG]="'/assets/icons/icon-save.svg'"></div>Save</button>
    </div>
</div>